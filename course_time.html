<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ˜ê°•ì‹ ì²­ ì‹œê°„í‘œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Malgun Gothic', sans-serif;
            padding: 40px 20px;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: #ffffff;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 40px;
            font-size: 32px;
            font-weight: 700;
        }
        
        .controls {
            margin-bottom: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .controls h3 {
            margin-bottom: 20px;
            color: #2d3748;
            font-size: 18px;
            font-weight: 600;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-group input, .input-group select {
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 14px;
            transition: all 0.3s ease;
            background-color: white;
        }
        
        .input-group input:focus, .input-group select:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }
        
        .btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #1e88e5 0%, #1565c0 100%);
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin-right: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(30, 136, 229, 0.4);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 136, 229, 0.6);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-delete {
            background: linear-gradient(135deg, #f56565 0%, #c53030 100%);
            box-shadow: 0 4px 15px rgba(245, 101, 101, 0.4);
        }
        
        .btn-delete:hover {
            box-shadow: 0 6px 20px rgba(245, 101, 101, 0.6);
        }
        
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 30px;
            overflow: hidden;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }
        
        th, td {
            border: 1px solid #e2e8f0;
            padding: 16px;
            text-align: center;
        }
        
        th {
            background: linear-gradient(135deg, #1565c0 0%, #0d47a1 100%);
            color: white;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.5px;
        }
        
        .period-header {
            background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
            color: white;
            font-weight: 600;
            width: 80px;
        }
        
        .time-cell {
            font-size: 13px;
            color: #4a5568;
            background-color: #f7fafc;
            font-weight: 500;
        }
        
        .class-cell {
            background-color: white;
            cursor: pointer;
            min-height: 70px;
            position: relative;
            vertical-align: top;
            padding: 8px;
            transition: background-color 0.2s ease;
        }
        
        .class-container {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            height: 100%;
        }
        
        .class-cell:hover {
            background-color: #f7fafc;
        }
        
        .class-info {
            background-color: #e3f2fd;
            border: 2px solid #2196F3;
            border-radius: 10px;
            padding: 12px;
            font-size: 13px;
            line-height: 1.5;
            position: relative;
            flex: 1;
            min-width: 130px;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.15);
            transition: all 0.2s ease;
        }
        
        .class-info:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(33, 150, 243, 0.25);
        }
        
        .class-name {
            font-weight: 700;
            color: #1976D2;
            margin-bottom: 6px;
            font-size: 14px;
        }
        
        .class-detail {
            font-size: 12px;
            color: #455a64;
            margin-top: 4px;
        }
        
        .delete-btn {
            position: absolute;
            top: 6px;
            right: 6px;
            background: linear-gradient(135deg, #f56565 0%, #c53030 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            line-height: 1;
            box-shadow: 0 2px 8px rgba(245, 101, 101, 0.3);
            transition: all 0.2s ease;
        }
        
        .delete-btn:hover {
            background: linear-gradient(135deg, #c53030 0%, #9b2c2c 100%);
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(245, 101, 101, 0.5);
        }
        
        .color-options {
            display: flex;
            gap: 12px;
            margin-top: 15px;
            align-items: center;
        }
        
        .color-options span {
            font-weight: 600;
            color: #2d3748;
        }
        
        .color-btn {
            width: 36px;
            height: 36px;
            border: 3px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .color-btn:hover {
            border-color: #2196F3;
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .color-btn:active {
            transform: scale(0.95);
        }
        
        /* ë°˜ì‘í˜• ë””ìì¸ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .controls {
                padding: 20px;
            }
            
            .input-group {
                grid-template-columns: 1fr;
            }
            
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“š ìˆ˜ê°•ì‹ ì²­ ì‹œê°„í‘œ (ì„œìš¸ìº í¼ìŠ¤)</h1>
        
        <div class="controls">
            <h3 style="margin-bottom: 15px;">ê³¼ëª© ì¶”ê°€</h3>
            <div class="input-group">
                <input type="text" id="courseName" placeholder="ê³¼ëª©ëª…" />
                <input type="text" id="professor" placeholder="êµìˆ˜ëª…" />
                <input type="text" id="room" placeholder="ê°•ì˜ì‹¤" />
                <select id="day">
                    <option value="">ìš”ì¼ ì„ íƒ</option>
                    <option value="ì›”">ì›”ìš”ì¼</option>
                    <option value="í™”">í™”ìš”ì¼</option>
                    <option value="ìˆ˜">ìˆ˜ìš”ì¼</option>
                    <option value="ëª©">ëª©ìš”ì¼</option>
                    <option value="ê¸ˆ">ê¸ˆìš”ì¼</option>
                </select>
                <select id="startPeriod">
                    <option value="">ì‹œì‘ êµì‹œ</option>
                    <option value="1">1êµì‹œ</option>
                    <option value="2">2êµì‹œ</option>
                    <option value="3">3êµì‹œ</option>
                    <option value="4">4êµì‹œ</option>
                    <option value="5">5êµì‹œ</option>
                    <option value="6">6êµì‹œ</option>
                    <option value="7">7êµì‹œ</option>
                    <option value="8">8êµì‹œ</option>
                    <option value="9">9êµì‹œ</option>
                    <option value="10">10êµì‹œ</option>
                </select>
                <select id="endPeriod">
                    <option value="">ì¢…ë£Œ êµì‹œ</option>
                    <option value="1">1êµì‹œ</option>
                    <option value="2">2êµì‹œ</option>
                    <option value="3">3êµì‹œ</option>
                    <option value="4">4êµì‹œ</option>
                    <option value="5">5êµì‹œ</option>
                    <option value="6">6êµì‹œ</option>
                    <option value="7">7êµì‹œ</option>
                    <option value="8">8êµì‹œ</option>
                    <option value="9">9êµì‹œ</option>
                    <option value="10">10êµì‹œ</option>
                </select>
            </div>
            <div class="color-options">
                <span style="margin-right: 10px; font-size: 14px;">ìƒ‰ìƒ:</span>
                <button class="color-btn" style="background-color: #e3f2fd; border-color: #2196F3;" onclick="selectColor('#e3f2fd', '#2196F3')"></button>
                <button class="color-btn" style="background-color: #fff3e0; border-color: #ff9800;" onclick="selectColor('#fff3e0', '#ff9800')"></button>
                <button class="color-btn" style="background-color: #f3e5f5; border-color: #9c27b0;" onclick="selectColor('#f3e5f5', '#9c27b0')"></button>
                <button class="color-btn" style="background-color: #e8f5e9; border-color: #4caf50;" onclick="selectColor('#e8f5e9', '#4caf50')"></button>
                <button class="color-btn" style="background-color: #fce4ec; border-color: #e91e63;" onclick="selectColor('#fce4ec', '#e91e63')"></button>
            </div>
            <div style="margin-top: 15px;">
                <button class="btn" onclick="addCourse()">ê³¼ëª© ì¶”ê°€</button>
                <button class="btn btn-delete" onclick="clearAll()">ì „ì²´ ì‚­ì œ</button>
                <button class="btn" style="background-color: #28a745;" onclick="downloadTimetable()">ğŸ“¥ ì´ë¯¸ì§€ë¡œ ì €ì¥</button>
                <button class="btn" style="background-color: #17a2b8;" onclick="shareTimeTable()">ğŸ”— ê³µìœ í•˜ê¸°</button>
            </div>
        </div>
        
        <table>
            <thead>
                <tr>
                    <th class="period-header">êµì‹œ<br>(Period)</th>
                    <th>ì‹œê°„</th>
                    <th>ì›” (Mon)</th>
                    <th>í™” (Tue)</th>
                    <th>ìˆ˜ (Wed)</th>
                    <th>ëª© (Thu)</th>
                    <th>ê¸ˆ (Fri)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="period-header">1</td>
                    <td class="time-cell">09:00~10:15<br><small>15ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="1"></td>
                    <td class="class-cell" data-day="í™”" data-period="1"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="1"></td>
                    <td class="class-cell" data-day="ëª©" data-period="1"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="1"></td>
                </tr>
                <tr>
                    <td class="period-header">2</td>
                    <td class="time-cell">10:30~11:45<br><small>15ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="2"></td>
                    <td class="class-cell" data-day="í™”" data-period="2"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="2"></td>
                    <td class="class-cell" data-day="ëª©" data-period="2"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="2"></td>
                </tr>
                <tr>
                    <td class="period-header">3</td>
                    <td class="time-cell">12:00~13:15<br><small>15ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="3"></td>
                    <td class="class-cell" data-day="í™”" data-period="3"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="3"></td>
                    <td class="class-cell" data-day="ëª©" data-period="3"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="3"></td>
                </tr>
                <tr>
                    <td class="period-header">4</td>
                    <td class="time-cell">13:30~14:45<br><small>15ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="4"></td>
                    <td class="class-cell" data-day="í™”" data-period="4"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="4"></td>
                    <td class="class-cell" data-day="ëª©" data-period="4"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="4"></td>
                </tr>
                <tr>
                    <td class="period-header">5</td>
                    <td class="time-cell">15:00~16:15<br><small>15ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="5"></td>
                    <td class="class-cell" data-day="í™”" data-period="5"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="5"></td>
                    <td class="class-cell" data-day="ëª©" data-period="5"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="5"></td>
                </tr>
                <tr>
                    <td class="period-header">6</td>
                    <td class="time-cell">16:30~17:45<br><small>15ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="6"></td>
                    <td class="class-cell" data-day="í™”" data-period="6"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="6"></td>
                    <td class="class-cell" data-day="ëª©" data-period="6"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="6"></td>
                </tr>
                <tr>
                    <td class="period-header">7</td>
                    <td class="time-cell">18:00~18:50<br><small>10ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="7"></td>
                    <td class="class-cell" data-day="í™”" data-period="7"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="7"></td>
                    <td class="class-cell" data-day="ëª©" data-period="7"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="7"></td>
                </tr>
                <tr>
                    <td class="period-header">8</td>
                    <td class="time-cell">19:00~19:50<br><small>10ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="8"></td>
                    <td class="class-cell" data-day="í™”" data-period="8"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="8"></td>
                    <td class="class-cell" data-day="ëª©" data-period="8"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="8"></td>
                </tr>
                <tr>
                    <td class="period-header">9</td>
                    <td class="time-cell">20:00~20:50<br><small>10ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="9"></td>
                    <td class="class-cell" data-day="í™”" data-period="9"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="9"></td>
                    <td class="class-cell" data-day="ëª©" data-period="9"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="9"></td>
                </tr>
                <tr>
                    <td class="period-header">10</td>
                    <td class="time-cell">21:00~21:50<br><small>10ë¶„ íœ´ì‹</small></td>
                    <td class="class-cell" data-day="ì›”" data-period="10"></td>
                    <td class="class-cell" data-day="í™”" data-period="10"></td>
                    <td class="class-cell" data-day="ìˆ˜" data-period="10"></td>
                    <td class="class-cell" data-day="ëª©" data-period="10"></td>
                    <td class="class-cell" data-day="ê¸ˆ" data-period="10"></td>
                </tr>
            </tbody>
        </table>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let courses = [];
        let selectedColor = '#e3f2fd';
        let selectedBorder = '#2196F3';

        // ìƒ‰ìƒ ì„ íƒ
        function selectColor(color, border) {
            selectedColor = color;
            selectedBorder = border;
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadData() {
            const saved = localStorage.getItem('timetable');
            if (saved) {
                courses = JSON.parse(saved);
                renderTimetable();
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥
        function saveData() {
            localStorage.setItem('timetable', JSON.stringify(courses));
        }

        // ê³¼ëª© ì¶”ê°€
        function addCourse() {
            const courseName = document.getElementById('courseName').value.trim();
            const professor = document.getElementById('professor').value.trim();
            const room = document.getElementById('room').value.trim();
            const day = document.getElementById('day').value;
            const startPeriod = parseInt(document.getElementById('startPeriod').value);
            const endPeriod = parseInt(document.getElementById('endPeriod').value);

            if (!courseName || !day || !startPeriod || !endPeriod) {
                alert('ê³¼ëª©ëª…, ìš”ì¼, ì‹œì‘/ì¢…ë£Œ êµì‹œë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            if (startPeriod > endPeriod) {
                alert('ì‹œì‘ êµì‹œê°€ ì¢…ë£Œ êµì‹œë³´ë‹¤ í´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }

            const newCourse = {
                id: Date.now(),
                courseName: courseName,
                professor: professor,
                room: room,
                day: day,
                startPeriod: startPeriod,
                endPeriod: endPeriod,
                color: selectedColor,
                borderColor: selectedBorder
            };

            courses.push(newCourse);
            saveData();
            renderTimetable();

            // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
            document.getElementById('courseName').value = '';
            document.getElementById('professor').value = '';
            document.getElementById('room').value = '';
            document.getElementById('day').value = '';
            document.getElementById('startPeriod').value = '';
            document.getElementById('endPeriod').value = '';
        }

        // ê³¼ëª© ì‚­ì œ
        function deleteCourse(courseId) {
            console.log('Deleting course with ID:', courseId);
            console.log('Current courses:', courses);
            
            if (!confirm('ì´ ê³¼ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }
            
            const beforeLength = courses.length;
            courses = courses.filter(c => c.id !== courseId);
            const afterLength = courses.length;
            
            console.log('Before:', beforeLength, 'After:', afterLength);
            
            if (beforeLength === afterLength) {
                console.log('WARNING: Course not found!');
            } else {
                console.log('Successfully deleted');
                saveData();
                renderTimetable();
            }
        }

        // ì „ì²´ ì‚­ì œ
        function clearAll() {
            if (confirm('ëª¨ë“  ê³¼ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                courses = [];
                saveData();
                renderTimetable();
            }
        }

        // ì‹œê°„í‘œ ë Œë”ë§
        function renderTimetable() {
            // ëª¨ë“  ì…€ ì´ˆê¸°í™”
            document.querySelectorAll('.class-cell').forEach(cell => {
                cell.innerHTML = '';
            });

            // ê° ìš”ì¼ë³„ë¡œ ì²˜ë¦¬
            const days = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ'];
            
            days.forEach(day => {
                // ì´ ìš”ì¼ì˜ ëª¨ë“  ê³¼ëª© ê°€ì ¸ì˜¤ê¸°
                const dayCourses = courses.filter(c => c.day === day);
                
                // ê³¼ëª©ë³„ë¡œ ì°¨ì§€í•˜ëŠ” êµì‹œ ë²”ìœ„ ê³„ì‚°í•˜ì—¬ ì—´ ë°°ì¹˜
                const courseColumns = [];
                
                dayCourses.forEach(course => {
                    // ì´ ê³¼ëª©ê³¼ ê²¹ì¹˜ëŠ” ê¸°ì¡´ ì—´ì´ ìˆëŠ”ì§€ í™•ì¸
                    let columnIndex = -1;
                    
                    for (let i = 0; i < courseColumns.length; i++) {
                        let hasConflict = false;
                        
                        for (let existingCourse of courseColumns[i]) {
                            // êµì‹œê°€ ê²¹ì¹˜ëŠ”ì§€ í™•ì¸
                            if (!(course.endPeriod < existingCourse.startPeriod || 
                                  course.startPeriod > existingCourse.endPeriod)) {
                                hasConflict = true;
                                break;
                            }
                        }
                        
                        if (!hasConflict) {
                            columnIndex = i;
                            break;
                        }
                    }
                    
                    // ê²¹ì¹˜ì§€ ì•ŠëŠ” ì—´ì´ ìˆìœ¼ë©´ ì¶”ê°€, ì—†ìœ¼ë©´ ìƒˆ ì—´ ìƒì„±
                    if (columnIndex === -1) {
                        courseColumns.push([course]);
                    } else {
                        courseColumns[columnIndex].push(course);
                    }
                });
                
                // ê° êµì‹œë³„ë¡œ ë Œë”ë§
                for (let period = 1; period <= 10; period++) {
                    const cell = document.querySelector(`[data-day="${day}"][data-period="${period}"]`);
                    if (!cell) continue;
                    
                    const container = document.createElement('div');
                    container.className = 'class-container';
                    
                    // ëª¨ë“  ì—´ì— ëŒ€í•´ ì²˜ë¦¬ (ê³¼ëª©ì´ ì—†ì–´ë„ ë¹ˆ ê³µê°„ ì¶”ê°€)
                    for (let colIdx = 0; colIdx < courseColumns.length; colIdx++) {
                        const column = courseColumns[colIdx];
                        const coursesInPeriod = column.filter(c => 
                            c.startPeriod <= period && c.endPeriod >= period
                        );
                        
                        if (coursesInPeriod.length > 0) {
                            const course = coursesInPeriod[0];
                            
                            // ì‹œì‘ êµì‹œì¸ ê²½ìš°ë§Œ ì „ì²´ ì •ë³´ í‘œì‹œ
                            if (course.startPeriod === period) {
                                const classDiv = document.createElement('div');
                                classDiv.className = 'class-info';
                                classDiv.style.backgroundColor = course.color;
                                classDiv.style.borderColor = course.borderColor;
                                
                                // ì‚­ì œ ë²„íŠ¼
                                const deleteBtn = document.createElement('button');
                                deleteBtn.className = 'delete-btn';
                                deleteBtn.textContent = 'Ã—';
                                deleteBtn.onclick = function(e) {
                                    e.stopPropagation();
                                    deleteCourse(course.id);
                                };
                                classDiv.appendChild(deleteBtn);
                                
                                // ê³¼ëª©ëª…
                                const nameDiv = document.createElement('div');
                                nameDiv.className = 'class-name';
                                nameDiv.textContent = course.courseName;
                                classDiv.appendChild(nameDiv);
                                
                                // êµìˆ˜ëª…
                                if (course.professor) {
                                    const profDiv = document.createElement('div');
                                    profDiv.className = 'class-detail';
                                    profDiv.textContent = `ğŸ‘¤ ${course.professor}`;
                                    classDiv.appendChild(profDiv);
                                }
                                
                                // ê°•ì˜ì‹¤
                                if (course.room) {
                                    const roomDiv = document.createElement('div');
                                    roomDiv.className = 'class-detail';
                                    roomDiv.textContent = `ğŸ“ ${course.room}`;
                                    classDiv.appendChild(roomDiv);
                                }
                                
                                // êµì‹œ ì •ë³´
                                const periodDiv = document.createElement('div');
                                periodDiv.className = 'class-detail';
                                const periodText = course.startPeriod === course.endPeriod 
                                    ? `ğŸ• ${course.startPeriod}êµì‹œ` 
                                    : `ğŸ• ${course.startPeriod}-${course.endPeriod}êµì‹œ`;
                                periodDiv.textContent = periodText;
                                classDiv.appendChild(periodDiv);
                                
                                container.appendChild(classDiv);
                            } else {
                                // ì—°ì† êµì‹œì¸ ê²½ìš° í™”ì‚´í‘œë§Œ í‘œì‹œ
                                const continueDiv = document.createElement('div');
                                continueDiv.className = 'class-info';
                                continueDiv.style.backgroundColor = course.color;
                                continueDiv.style.borderColor = course.borderColor;
                                continueDiv.style.opacity = '0.7';
                                
                                const nameDiv = document.createElement('div');
                                nameDiv.className = 'class-name';
                                nameDiv.style.fontSize = '12px';
                                nameDiv.textContent = `â†‘ ${course.courseName}`;
                                continueDiv.appendChild(nameDiv);
                                
                                container.appendChild(continueDiv);
                            }
                        } else {
                            // ì´ ì—´ì— ê³¼ëª©ì´ ì—†ìœ¼ë©´ ë¹ˆ ê³µê°„ ì¶”ê°€ (ì—´ ì •ë ¬ ìœ ì§€)
                            const emptyDiv = document.createElement('div');
                            emptyDiv.className = 'class-info';
                            emptyDiv.style.visibility = 'hidden';
                            emptyDiv.style.border = 'none';
                            emptyDiv.style.backgroundColor = 'transparent';
                            container.appendChild(emptyDiv);
                        }
                    }
                    
                    if (container.children.length > 0) {
                        cell.appendChild(container);
                    }
                }
            });
        }

        // ì‹œê°„í‘œ ê³µìœ í•˜ê¸°
        function shareTimeTable() {
            if (courses.length === 0) {
                alert('ê³µìœ í•  ê³¼ëª©ì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì‹œê°„í‘œ ë°ì´í„°ë¥¼ Base64ë¡œ ì¸ì½”ë”©
            const dataStr = JSON.stringify(courses);
            const encodedData = btoa(encodeURIComponent(dataStr));
            
            // URL ìƒì„±
            const currentUrl = window.location.href.split('?')[0];
            const shareUrl = `${currentUrl}?data=${encodedData}`;
            
            // í´ë¦½ë³´ë“œì— ë³µì‚¬
            navigator.clipboard.writeText(shareUrl).then(() => {
                alert('ê³µìœ  ë§í¬ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ ë§í¬ë¥¼ ë‹¤ë¥¸ ì‚¬ëŒì—ê²Œ ë³´ë‚´ë©´ ë™ì¼í•œ ì‹œê°„í‘œë¥¼ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            }).catch(() => {
                // í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨ ì‹œ ì§ì ‘ í‘œì‹œ
                prompt('ì´ ë§í¬ë¥¼ ë³µì‚¬í•´ì„œ ê³µìœ í•˜ì„¸ìš”:', shareUrl);
            });
        }
        
        // URLì—ì„œ ê³µìœ ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function loadSharedData() {
            const urlParams = new URLSearchParams(window.location.search);
            const sharedData = urlParams.get('data');
            
            if (sharedData) {
                try {
                    const decodedData = decodeURIComponent(atob(sharedData));
                    const sharedCourses = JSON.parse(decodedData);
                    
                    if (confirm('ê³µìœ ëœ ì‹œê°„í‘œë¥¼ ë¶ˆëŸ¬ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?\n(í˜„ì¬ ì‹œê°„í‘œëŠ” ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤)')) {
                        courses = sharedCourses;
                        saveData();
                        renderTimetable();
                        alert('ê³µìœ ëœ ì‹œê°„í‘œë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!');
                        
                        // URLì—ì„œ íŒŒë¼ë¯¸í„° ì œê±°
                        window.history.replaceState({}, document.title, window.location.pathname);
                    }
                } catch (error) {
                    console.error('Error loading shared data:', error);
                }
            }
        }

        // ì‹œê°„í‘œ ì´ë¯¸ì§€ë¡œ ë‹¤ìš´ë¡œë“œ
        function downloadTimetable() {
            const container = document.querySelector('.container');
            
            // html2canvasë¡œ ìŠ¤í¬ë¦°ìƒ· ìƒì„±
            html2canvas(container, {
                scale: 2, // ê³ í•´ìƒë„
                backgroundColor: '#ffffff',
                logging: false,
                useCORS: true
            }).then(canvas => {
                // Canvasë¥¼ ì´ë¯¸ì§€ë¡œ ë³€í™˜
                const link = document.createElement('a');
                const today = new Date();
                const dateStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
                link.download = `ìˆ˜ê°•ì‹ ì²­_ì‹œê°„í‘œ_${dateStr}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(error => {
                console.error('Error generating image:', error);
                alert('ì´ë¯¸ì§€ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            });
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        window.onload = function() {
            loadSharedData(); // ê³µìœ ëœ ë°ì´í„° í™•ì¸
            loadData(); // ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        };
    </script>
</body>
</html>